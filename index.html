<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Coding Challenges Hub</title>
    <style>
      :root {
        color-scheme: light dark;
        font-family: "Inter", system-ui, -apple-system, "Segoe UI", sans-serif;
        --surface: rgba(255, 255, 255, 0.9);
        --surface-dark: rgba(15, 23, 42, 0.85);
        --border: rgba(148, 163, 184, 0.6);
        --accent: #2563eb;
        --accent-soft: rgba(37, 99, 235, 0.14);
        --text: #0f172a;
        --text-subtle: #475569;
        --bg: radial-gradient(circle at top, #e2e8f0, #cbd5f5);
        --code-bg: #0f172a;
        --code-text: #e2e8f0;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        display: grid;
        grid-template-columns: minmax(240px, 280px) 1fr;
        background: var(--bg);
        color: var(--text);
      }

      aside {
        background: var(--surface);
        backdrop-filter: blur(16px);
        border-right: 1px solid var(--border);
        padding: 2rem 1.5rem;
        display: flex;
        flex-direction: column;
        gap: 2.5rem;
      }

      h1 {
        font-size: clamp(1.6rem, 1.3vw + 1rem, 2rem);
        margin: 0;
        font-weight: 700;
        line-height: 1.3;
      }

      nav {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }

      button.section-link {
        appearance: none;
        border: 1px solid transparent;
        background: transparent;
        color: inherit;
        font: inherit;
        padding: 0.75rem 1rem;
        border-radius: 0.75rem;
        text-align: left;
        cursor: pointer;
        transition: background 150ms ease, border-color 150ms ease, transform 150ms ease;
      }

      button.section-link:hover,
      button.section-link:focus-visible {
        background: var(--accent-soft);
        border-color: rgba(37, 99, 235, 0.2);
        outline: none;
        transform: translateX(4px);
      }

      button.section-link[aria-current="page"] {
        background: var(--accent);
        border-color: var(--accent);
        color: white;
        font-weight: 600;
        box-shadow: 0 15px 35px -25px rgba(37, 99, 235, 0.75);
      }

      main {
        padding: clamp(1.5rem, 2vw + 1rem, 3rem);
        display: grid;
        gap: clamp(1.5rem, 2vw, 3rem);
      }

      .section-header {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .section-header h2 {
        margin: 0;
        font-size: clamp(1.6rem, 2vw + 1rem, 2.4rem);
      }

      .section-header p {
        margin: 0;
        color: var(--text-subtle);
        font-size: 1rem;
      }

      .note-card {
        background: var(--surface);
        backdrop-filter: blur(14px);
        border: 1px solid var(--border);
        border-radius: 1rem;
        padding: clamp(1.25rem, 1.2vw + 1rem, 1.75rem);
        display: grid;
        gap: 1rem;
      }

      .note-card h3 {
        margin: 0;
        font-size: 1.1rem;
      }

      .note-card ul,
      .note-card ol {
        margin: 0;
        padding-left: 1.25rem;
        color: var(--text-subtle);
        font-size: 0.95rem;
        line-height: 1.6;
      }

      .editor-wrapper {
        display: grid;
        gap: 0.75rem;
      }

      label {
        font-weight: 600;
      }

      textarea {
        width: 100%;
        min-height: 200px;
        border-radius: 0.85rem;
        border: 1px solid rgba(15, 23, 42, 0.25);
        padding: 1rem;
        font: 0.95rem/1.6 "Fira Code", "JetBrains Mono", ui-monospace, SFMono-Regular, "Menlo";
        resize: vertical;
        color: var(--code-text);
        background: var(--code-bg);
        box-shadow: inset 0 12px 24px -18px rgba(15, 23, 42, 0.9);
      }

      textarea:focus-visible {
        outline: 2px solid rgba(37, 99, 235, 0.65);
        outline-offset: 2px;
      }

      .actions {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        align-items: center;
      }

      .actions button {
        border: none;
        border-radius: 999px;
        padding: 0.65rem 1.5rem;
        font-weight: 600;
        font-size: 0.95rem;
        cursor: pointer;
        background: var(--accent);
        color: white;
        box-shadow: 0 10px 30px -20px rgba(37, 99, 235, 0.8);
        transition: transform 120ms ease, box-shadow 120ms ease;
      }

      .actions button.secondary {
        background: rgba(15, 23, 42, 0.08);
        color: inherit;
        box-shadow: none;
      }

      .actions button:hover {
        transform: translateY(-1px);
        box-shadow: 0 14px 32px -18px rgba(37, 99, 235, 0.75);
      }

      pre.output {
        margin: 0;
        border-radius: 0.85rem;
        padding: 1rem;
        background: rgba(15, 23, 42, 0.92);
        color: #f8fafc;
        font: 0.9rem/1.6 "Fira Code", "JetBrains Mono", ui-monospace, SFMono-Regular, "Menlo";
        white-space: pre-wrap;
        word-break: break-word;
        min-height: 120px;
      }

      .task-list {
        display: grid;
        gap: 1rem;
      }

      .task-list article {
        border-radius: 0.85rem;
        border: 1px solid var(--border);
        padding: 1.25rem;
        background: rgba(248, 250, 252, 0.85);
      }

      .task-list h4 {
        margin: 0 0 0.5rem;
      }

      .task-list p {
        margin: 0;
        color: var(--text-subtle);
        font-size: 0.95rem;
        line-height: 1.5;
      }

      @media (max-width: 960px) {
        body {
          grid-template-columns: 1fr;
          grid-template-rows: auto 1fr;
        }

        aside {
          position: sticky;
          top: 0;
          z-index: 2;
          flex-direction: column;
          gap: 1.5rem;
          border-right: none;
          border-bottom: 1px solid var(--border);
        }
      }
    </style>
  </head>
  <body>
    <aside>
      <header>
        <h1>Coding Challenges Hub</h1>
        <p style="color: var(--text-subtle); margin: 0.35rem 0 0;">
          Practice JavaScript interactively with focused notes and exercises.
        </p>
      </header>
      <nav id="navigation" aria-label="Section navigation"></nav>
    </aside>
    <main>
      <section class="section-header">
        <h2 id="section-title">Welcome</h2>
        <p id="section-description">
          Choose a topic from the sidebar to reveal its learning notes and
          practice area.
        </p>
      </section>
      <section class="note-card">
        <h3>How to use this page</h3>
        <ol>
          <li>Pick a section such as <strong>Strings</strong> or <strong>Arrays</strong>.</li>
          <li>Read through the curated notes and hints.</li>
          <li>Type your solution in the code editor and run the tests.</li>
          <li>Adjust and retry until all checks pass.</li>
        </ol>
      </section>
      <section class="note-card" id="notes-card">
        <h3>Key notes</h3>
        <ul id="notes-list">
          <li>Your study tips for the current topic will show up here.</li>
        </ul>
      </section>
      <section class="note-card editor-wrapper">
        <label for="code">Your solution</label>
        <textarea id="code" spellcheck="false" aria-label="Code editor">
// Select a section to load the starter code here.</textarea
        >
        <div class="actions">
          <button type="button" id="run">Run tests</button>
          <button type="button" class="secondary" id="reset">Reset code</button>
        </div>
        <div>
          <h3 style="margin-bottom: 0.5rem;">Output</h3>
          <pre class="output" id="output">Tests will appear here once you start coding.</pre>
        </div>
      </section>
      <section class="note-card task-list" id="tasks">
        <article>
          <h4>Ready to start?</h4>
          <p>Select any section to load detailed tasks and examples.</p>
        </article>
      </section>
    </main>
    <script>
      const sections = [
        {
          id: "strings",
          title: "Strings",
          description:
            "Work with individual characters, learn how to transform and inspect text.",
          notes: [
            "Remember that strings are immutable; create new ones when editing.",
            "Use slice(-1) to access the last character quickly.",
            "Template literals make it easy to combine values with `${value}` syntax.",
          ],
          starterCode: `function removeLastLetter(text) {\n  if (typeof text !== 'string') {\n    throw new TypeError('Expected a string');\n  }\n  return text.slice(0, -1);\n}\n\n// Try the helper below\nconsole.log(removeLastLetter('Learn')); // -> 'Lear'\n`,
          tasks: [
            {
              title: "Remove the final character",
              description:
                "Implement removeLastLetter so that it returns the provided string without its final character.",
              tests(code) {
                const fn = getExportedFunction(code, "removeLastLetter");
                assertEqual(fn("Notebook"), "Noteboo");
                assertEqual(fn("Code"), "Cod");
                assertEqual(fn("A"), "");
              },
            },
            {
              title: "Bonus: trim punctuation",
              description:
                "Adapt your function to remove trailing punctuation marks like !, ?, or . when present.",
            },
          ],
        },
        {
          id: "arrays",
          title: "Arrays",
          description:
            "Master common array helpers to transform and combine collections.",
          notes: [
            "Array.prototype.map creates a new array without mutating the original.",
            "Spread syntax [...] is perfect for copying or merging arrays.",
            "Use Array.prototype.filter when you want to remove elements that do not match a condition.",
          ],
          starterCode: `function doublePositiveNumbers(values) {\n  if (!Array.isArray(values)) {\n    throw new TypeError('Expected an array');\n  }\n  return values\n    .filter((value) => typeof value === 'number' && value > 0)\n    .map((value) => value * 2);\n}\n\nconsole.log(doublePositiveNumbers([-2, 1, 3])); // -> [2, 6]\n`,
          tasks: [
            {
              title: "Double only positive numbers",
              description:
                "Return a new array containing each positive number multiplied by two. Ignore non-numeric values.",
              tests(code) {
                const fn = getExportedFunction(code, "doublePositiveNumbers");
                assertDeepEqual(fn([-1, 0, 2, 5]), [4, 10]);
                assertDeepEqual(fn([3, "3", 4]), [6, 8]);
                assertDeepEqual(fn([]), []);
              },
            },
            {
              title: "Bonus: handle nested arrays",
              description:
                "Flatten one nesting level before processing the values to support inputs such as [1, [2, 3]].",
            },
          ],
        },
        {
          id: "settings",
          title: "Settings",
          description:
            "Personalize the experience and keep private notes for your study sessions.",
          notes: [
            "Toggle light/dark appearance by using the switch below.",
            "Store quick personal reminders in local storage.",
            "Reset the editor at any time to load the starter code again.",
          ],
          starterCode: `// Use these helpers to experiment with settings.\nconst preferences = {\n  theme: localStorage.getItem('theme') || 'system',\n  notes: localStorage.getItem('notes') || '',\n};\n\nfunction updateTheme(nextTheme) {\n  preferences.theme = nextTheme;\n  localStorage.setItem('theme', nextTheme);\n  return preferences.theme;\n}\n\nfunction saveNotes(content) {\n  preferences.notes = content;\n  localStorage.setItem('notes', content);\n  return preferences.notes;\n}\n\nconsole.log(updateTheme('dark'));
console.log(saveNotes('Remember to review array methods.'));
`,
          tasks: [
            {
              title: "Persist settings",
              description:
                "Update updateTheme so that it stores the new preference in local storage and returns it.",
              tests(code) {
                const sandbox = createSandbox();
                const fn = getExportedFunction(code, "updateTheme", sandbox);
                assertEqual(fn("dark"), "dark");
                assertEqual(sandbox.localStorage.getItem("theme"), "dark");
              },
            },
            {
              title: "Save your notes",
              description:
                "Make sure saveNotes keeps the latest notes both in memory and inside local storage.",
              tests(code) {
                const sandbox = createSandbox();
                const fn = getExportedFunction(code, "saveNotes", sandbox);
                assertEqual(fn("Study slice vs substring"), "Study slice vs substring");
                assertEqual(
                  sandbox.localStorage.getItem("notes"),
                  "Study slice vs substring"
                );
              },
            },
          ],
        },
      ];

      const navigation = document.getElementById("navigation");
      const sectionTitle = document.getElementById("section-title");
      const sectionDescription = document.getElementById("section-description");
      const notesList = document.getElementById("notes-list");
      const tasksContainer = document.getElementById("tasks");
      const codeEditor = document.getElementById("code");
      const runButton = document.getElementById("run");
      const resetButton = document.getElementById("reset");
      const output = document.getElementById("output");
      let currentSection = null;

      function renderNavigation() {
        sections.forEach((section, index) => {
          const button = document.createElement("button");
          button.type = "button";
          button.textContent = section.title;
          button.className = "section-link";
          button.addEventListener("click", () => setSection(section.id));
          if (index === 0) {
            button.setAttribute("data-default", "");
          }
          navigation.appendChild(button);
        });
      }

      function setSection(id) {
        const section = sections.find((entry) => entry.id === id);
        if (!section) {
          return;
        }
        currentSection = section;
        updateNavigation();
        sectionTitle.textContent = section.title;
        sectionDescription.textContent = section.description;
        renderNotes(section.notes);
        renderTasks(section.tasks);
        codeEditor.value = section.starterCode.trim();
        output.textContent = "Tests will appear here once you start coding.";
      }

      function updateNavigation() {
        const buttons = navigation.querySelectorAll("button.section-link");
        buttons.forEach((button) => {
          const isActive = currentSection && button.textContent === currentSection.title;
          button.setAttribute("aria-current", isActive ? "page" : "false");
        });
      }

      function renderNotes(notes) {
        notesList.innerHTML = "";
        notes.forEach((note) => {
          const li = document.createElement("li");
          li.textContent = note;
          notesList.appendChild(li);
        });
      }

      function renderTasks(tasks) {
        tasksContainer.innerHTML = "";
        tasks.forEach((task) => {
          const article = document.createElement("article");
          const title = document.createElement("h4");
          const description = document.createElement("p");
          title.textContent = task.title;
          description.textContent = task.description;
          article.appendChild(title);
          article.appendChild(description);
          tasksContainer.appendChild(article);
        });
      }

      function createSandbox() {
        const storage = new Map();
        return {
          console,
          localStorage: {
            getItem(key) {
              return storage.has(key) ? storage.get(key) : null;
            },
            setItem(key, value) {
              storage.set(key, String(value));
            },
            removeItem(key) {
              storage.delete(key);
            },
            clear() {
              storage.clear();
            },
          },
        };
      }

      const baseScope = {
        console,
        Math,
        Number,
        String,
        Boolean,
        Array,
        Object,
        JSON,
        Date,
        RegExp,
        Set,
        Map,
      };

      function getExportedFunction(code, name, sandboxOverrides) {
        const scope = Object.assign({}, baseScope, sandboxOverrides || {});
        const fn = new Function(
          "sandbox",
          `with (sandbox) { ${code}; return typeof ${name} !== 'undefined' ? ${name} : sandbox['${name}']; }`
        )(scope);
        if (sandboxOverrides) {
          sandboxOverrides[name] = fn;
        }
        if (typeof fn !== "function") {
          throw new Error(`Function ${name} is not defined.`);
        }
        return fn;
      }

      function assertEqual(received, expected) {
        if (received !== expected) {
          throw new Error(`Expected ${JSON.stringify(expected)} but received ${JSON.stringify(received)}`);
        }
      }

      function assertDeepEqual(received, expected) {
        const r = JSON.stringify(received);
        const e = JSON.stringify(expected);
        if (r !== e) {
          throw new Error(`Expected ${e} but received ${r}`);
        }
      }

      function runTests() {
        if (!currentSection) {
          output.textContent = "Select a section to run its tests.";
          return;
        }
        const section = currentSection;
        const code = codeEditor.value;
        const results = [];
        section.tasks.forEach((task) => {
          if (typeof task.tests !== "function") {
            results.push(`• ${task.title}: (no automated tests yet)`);
            return;
          }
          try {
            task.tests(code);
            results.push(`• ${task.title}: ✅ Passed`);
          } catch (error) {
            results.push(`• ${task.title}: ❌ ${error.message}`);
          }
        });
        output.textContent = results.join("\n");
      }

      function resetCode() {
        if (!currentSection) {
          output.textContent = "Select a section to load its starter code.";
          return;
        }
        codeEditor.value = currentSection.starterCode.trim();
        output.textContent = "Starter code restored. Run the tests to verify.";
      }

      runButton.addEventListener("click", runTests);
      resetButton.addEventListener("click", resetCode);

      renderNavigation();
      setSection(sections[0].id);
    </script>
  </body>
</html>
